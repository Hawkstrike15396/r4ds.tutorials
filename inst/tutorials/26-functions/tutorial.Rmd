---
title: "Functions"
author: "Anish Bellamkonda"
tutorial:
  id: functions
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: "Tutorial for Chapter 26: Functions"
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(tidyverse)
library(nycflights13)
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 
```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

<!-- CHECKLIST BEFORE STARTING: -->
<!-- * Edit yaml at the top of this file -->
<!-- * Save the file as "tutorial.Rmd" in a new directory under inst/tutorials/. -->
<!-- * Load any necessary libraries for the tutorial in the first code chunk -->
<!-- * Review: https://ppbds.github.io/tutorial.helpers/articles/instructions.html -->
<!-- * Delete this and the other commented instructions below. -->

## Introduction
###


## Vector Functions
###

### Exercise 1

We’ll begin with vector functions: functions that take one or more vectors and return a vector result. Let's first give you an example on why you need functions instead of copy and pasting commands.

Create a variable `df` and assign `tibble()` to it. We will have 4 columns: `a`, `b`, `c`,`d`. For all four columns assign `rnorm(5)`. 

```{r vector-functions-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-1-hint, eval = FALSE}

```

###

If you want to explore what `rnorm()` does check out this [website](https://r-lang.com/rnorm-function-in-r/)

### Exercise 2


```{r vector-functions-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-2-hint, eval = FALSE}

```

###

### Exercise 3


```{r vector-functions-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-3-hint, eval = FALSE}

```

###

### Exercise 4


```{r vector-functions-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-4-hint, eval = FALSE}

```

###

### Exercise 5


```{r vector-functions-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-5-hint, eval = FALSE}

```

###

### Exercise 6


```{r vector-functions-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r vector-functions-6-hint, eval = FALSE}

```

###




## Data Frame Functions
###

### Exercise 1


```{r data-frame-functions-1, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-1-hint, eval = FALSE}

```

###

### Exercise 2


```{r data-frame-functions-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-2-hint, eval = FALSE}

```

###

### Exercise 3


```{r data-frame-functions-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-3-hint, eval = FALSE}

```

###

### Exercise 4


```{r data-frame-functions-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-4-hint, eval = FALSE}

```

###

### Exercise 5


```{r data-frame-functions-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-5-hint, eval = FALSE}

```

###

### Exercise 6


```{r data-frame-functions-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-6-hint, eval = FALSE}

```

###

### Exercise 7


```{r data-frame-functions-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r data-frame-functions-7-hint, eval = FALSE}

```

###



## Plot Functions
###

Instead of returning a data frame, you might want to return a plot. Fortunately, you can use the same techniques with ggplot2, because `aes()` is a data-masking function. For example, imagine that you’re making a lot of histograms like the following:

```{r}
knitr::include_graphics("images/img.png")
```

Wouldn’t it be nice if you could wrap this up into a histogram function?

### Exercise 1

Creating a plot function becomes effortless once you understand that `aes()` serves as a data-masking function. Let's name the function `histogram` and assign it to `function()`. The function will require three variables: `df` for the dataset, `var` for the variable, and `binwidth`, which is set to `NULL` and determines the size of each bar when left empty.

```{r plot-functions-1, exercise = TRUE}

```


```{r plot-functions-1-hint, eval = FALSE}
histogram <- ...(...,var,binwidth = ...){
  
}
```

###

The reason we set `binwidth` to `NULL` is because the `binwidth` is a optional variable that you can modify when using the function.  

### Exercise 2

Copying the previous code, within the curly braces of `function()`, start a new pipe with `df` to `ggplot()`. Within `aes()` in `ggplot()`, set `x` to `{{x}}`. Then add the `geom_histogram()` layer using `+` and set `binwidth = binwidth`.

```{r plot-functions-2, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r plot-functions-2-hint, eval = FALSE}
.... <- ...(...,var,binwidth = ...){
  df |>
    ggplot(aes(... = ...))+
    geom_...(binwidth =...)
}
```

###

Now that we have the function ready and good to get, let's use it on datsets.

### Exercise 3

Start a pipe with `diamonds` data set to `histogram()` and set the first argument to `carat` and second to `.1`.

```{r plot-functions-3, exercise = TRUE}

```


```{r plot-functions-3-hint, eval = FALSE}
diamonds |> histogram(..., 0.1)
```

###

To clarify and clear up some confusion, we already set `df` to `diamonds` with the pipe and setting the rest values within the function call.

### Exercise 4

Note that `histogram()` returns a ggplot2 plot, allowing you to add additional components as desired. To enhance the graph, let's incorporate `labs()`. Copy the previous code and add `labs()` using `+`, setting `x` to `"Size (in carats)"`, and `y` to `"Number of diamonds"`.

```{r plot-functions-4, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r plot-functions-4-hint, eval = FALSE}
... |> 
  histogram(..., 0.1) +
  labs(... = "Size (in carats)", y = "...")
```

###

Next up, we will talk about adding more variable to the function.

### Exercise 5


```{r plot-functions-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r plot-functions-5-hint, eval = FALSE}

```

###

### Exercise 6


```{r plot-functions-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r plot-functions-6-hint, eval = FALSE}

```

###

### Exercise 7


```{r plot-functions-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r plot-functions-7-hint, eval = FALSE}

```

###




## Style
###

R doesn’t care what your function or arguments are called but the names make a big difference for humans. Ideally, the name of your function will be short, but clearly evoke what the function does. That’s hard! But it’s better to be clear than short, as RStudio’s autocomplete makes it easy to type long names.

### Exercise 1

Generally, function names should be verbs, and arguments should be nouns. However, there are some exceptions. It is acceptable to use nouns if the function computes a well-known noun (e.g., "mean()" is preferred over "compute_mean()") or if it accesses a property of an object (e.g., "coef()" is preferred over "get_coefficients()"). Trust your judgment and feel free to rename a function if you come up with a better name later on.

In next few exercises we will show you different examples for the names of functions. Below is one:

```{r}
#f()
```

This name is too short and doesn't mean anything but just the word `f`.

###

### Exercise 2

Below is another example:

```{r}
#my_awesome_function()
```

This name is not a verb and also is not descriptive at the same time  like the function above.

###

### Exercise 3

Below is another example:

```{r style-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r style-3-hint, eval = FALSE}
#impute_missing()
#collapse_years()
```

###

Even though this function name is clear, it is still little to long for us to type again and again.

### Exercise 4

R also doesn’t care about how you use white space in your functions but future readers will. Additionally, `function()` should always be followed by squiggly brackets `({})`, and the contents should be indented by an additional two spaces. This makes it easier to see the hierarchy in your code by skimming the left-hand margin. 

Here is a good example of good indentation, which helps us see the hierarchy in the code.

```{r}
density <- function(color, facets, binwidth = 0.1) {
diamonds |> 
  ggplot(aes(x = carat, y = after_stat(density), color = {{ color }})) +
  geom_freqpoly(binwidth = binwidth) +
  facet_wrap(vars({{ facets }}))
}
```

###

Missing extra two spaces

### Exercise 5

Below is a example of having two extra spaces:

```{r}
density <- function(color, facets, binwidth = 0.1) {
  diamonds |> 
  ggplot(aes(x = carat, y = after_stat(density), color = {{ color }})) +
  geom_freqpoly(binwidth = binwidth) +
  facet_wrap(vars({{ facets }}))
}
```

###

In the code above the pipe is indented incorrectly. As you can see we recommend putting extra spaces inside of `{{ }}`. This makes it very obvious that something unusual is happening.

## Summary
###

<!-- Two to four sentences which bring the lessons of the tutorial together for the student. What do they know now that they did not know before? How does this tutorial connect to other tutorials? OK if this is very similar to the Introduction. You made a promise as to what they would learn. You (we hope!) kept that promise.-->

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
