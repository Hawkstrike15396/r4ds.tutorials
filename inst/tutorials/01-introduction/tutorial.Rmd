---
title: Introduction
author: David Kane
tutorial:
  id: introduction
output:
  learnr::tutorial:
    progressive: yes
    allow_skip: yes
runtime: shiny_prerendered
description: 'Tutorial for Chapter 1: Introduction'
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(tidyverse)

knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 

```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

## Introduction
### 

This tutorial covers [Chapter 1: Introduction](https://r4ds.hadley.nz/intro.html) from [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. 

The promise we make to teachers is that these tutorials will ensure that your students type in 90% of the code which appears in the associated chapter. This chapter has very little R code. So, in the spirit of getting started, we include some of our own.

### 

This tutorial assumes that you have already completed the Getting Started tutorial in the [**tutorial.helpers**](https://ppbds.github.io/tutorial.helpers/) package. If you haven't, do so now. It is quick!


## What you will learn
### 

In this tutorial, we will only work within the Exercise Code Blocks. However, you can also put the commands into the Console tab in the lower left. 


### Exercise 1

Type `2 + 2` and hit "Run Code."

```{r what-you-will-learn-1, exercise = TRUE}

```

```{r what-you-will-learn-1-hint-1, eval = FALSE}
2 + 2
```

### 

Data science is a vast field, and there’s no way you can master it all by reading a single book. This book aims to give you a solid foundation in the most important tools and enough knowledge to find the resources to learn more when necessary. Our model of the steps of a typical data science project looks something like this:

```{r overview}
knitr::include_graphics("images/base.png")
```

### Exercise 2

Before you start doing data science, you must load the packages you are going to use. In the code chunk below, use the function `library()` to load the **tidyverse** package.

```{r what-you-will-learn-2, exercise = TRUE}

```

```{r what-you-will-learn-2-hint-1, eval = FALSE}
library(tidyverse)
```

### 

The **[tidyverse](https://www.tidyverse.org/)** is a collection of R packages used by data scientists and maintained by [Posit](https://posit.co/), the company formerly known as RStudio. 



### Exercise 3

If you are ever stuck while coding, R has *help pages*. Let's say we want to know what the function `sqrt()` does. Open the help page for `sqrt()` by typing `?sqrt` below.

```{r what-you-will-learn-3, exercise = TRUE}

```

### 

You can also use the `?` to open the help page for a data set. 

### Exercise 4

Type `?diamonds` to look up the help page for the `diamonds` tibble from the **ggplot2** package, which is one of the core packages in the *Tidyverse*.

```{r what-you-will-learn-4, exercise = TRUE}

```

Copy/paste the Description from the help page into the box below.

```{r looking-at-data-4-b}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

You can find help about an entire package with `help(package = "ggplot2")`. It is confusing, but unavoidable, that package names are sometimes unquoted, as in `library(ggplot2)`, and sometimes quoted, as in `help(package = "ggplot2")`. If one does not work, try the other.

### 

Note that, for historical reasons, we refer to R packages like **ggplot2** as *packages* most commonly, but also as *libraries*. That is the reason why the `library()` function is used to load packages.


### Exercise 5

Assign the value of `sqrt(144)` to the variable `x`. Remember to use the assignment operator `<-`.

```{r what-you-will-learn-5, exercise = TRUE}

```

```{r what-you-will-learn-5-hint-1, eval = FALSE}
x <- sqrt(144)
```

### 

Although there are [two additional assignment operators](https://stat.ethz.ch/R-manual/R-devel/library/base/html/assignOps.html), you should use `<-`. 



### Exercise 6

Data frames, also referred to as "tibbles", are spreadsheet-type data sets. 

### 

In data science, it's always a good idea to explore the data before you use it. You can simply examine a data set by typing its name. Let's examine the contents of `diamonds` data set. Type `diamonds` in the line below.

```{r what-you-will-learn-6, exercise = TRUE}

```

### 

In tibbles, column headers are referred to as **variables** and each row of data is referred to as an **observation**.


### Exercise 7

When we type the name of a tibble in the R Console, we are implicitly using the `print()` function. Try it by using `print()` on `diamonds`.

```{r what-you-will-learn-7, exercise = TRUE}

```

```{r what-you-will-learn-7-hint-1, eval = FALSE}
print(diamonds)
```

This produces the same result as just typing `diamonds`. But `print()` is more flexible, allowing us to specify different numbers of rows and columns.

### Exercise 8

Print out the first three rows of `diamonds`.

```{r what-you-will-learn-8, exercise = TRUE}

```

```{r what-you-will-learn-8-hint-1, eval = FALSE}
print(diamonds, n = 3)
```

### 

Use the `width` argument to change how many columns appear. `print(diamonds, n = Inf, width = Inf)` will cause everything to be printed.


### Exercise 9

Now use `glimpse()` to look at the `diamonds` data set. To learn more about the `glimpse()` function, run `?glimpse`.

```{r what-you-will-learn-9, exercise = TRUE}

```

```{r what-you-will-learn-9-hint-1, eval = FALSE}
glimpse(diamonds)
```

### 

`glimpse()` displays columns running down the page and the data running across across. Note how the "type" of each variable is listed next to the variable name. For example, `gender` is listed as `<chr>`, meaning that it is a character variable.

`view()` is another useful function, but, because it is interactive, we can't use it within a tutorial. 

### Exercise 10

Run `summary()` on `diamonds`.

```{r what-you-will-learn-10, exercise = TRUE}

```

```{r what-you-will-learn-10-hint-1, eval = FALSE}
summary(...)
```

### 

For each variable, the `summary()` function produces summary statistics about that variable.

### Exercise 11

*Code comments* are text placed after a `#` symbol. Nothing will be run after a `#` symbol, which is useful if you want to write human readable comments in your code.

### 

Press Run Code. Afterwards, add the `#` and re-run the chunk. You should no longer see a result.

```{r what-you-will-learn-11, exercise = TRUE}
sqrt(144)
```

## How this book is organized
### 

## What you won’t learn
### 

Let's create the following scatterplot from the `mpg` dataset, which provides measurements of attributes from various car models.

```{r scat-p}
scat_p <- ggplot(data = mpg, 
                 mapping = aes(x = displ, 
                               y = hwy)) +
  geom_point(alpha = 0.5, color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency of Select Car Models",
       subtitle = "Cars with greater engineer displacement are less fuel efficient",
        x = "Engine Displacement (L)",
        y = "Highway Efficiency (mpg)", 
       caption = "EPA (2008)")

scat_p
```

### Exercise 1

First, let's `glimpse()` the data set used above called `mpg`. Looking at the axis titles, can you determine what the names are for the two variables we will use?

```{r what-you-wont-learn-1, exercise = TRUE}

```

```{r what-you-wont-learn-1-hint-1, eval = FALSE}
glimpse(...)
```

### 

`glimpse()` is most effective when you want to see both all the variables of a data set and many observations.

We are going to use `displ` and `hwy` to create this plot.

### Exercise 2

Within `ggplot()`, set `data` to `mpg`.

```{r what-you-wont-learn-2, exercise = TRUE}

```

```{r what-you-wont-learn-2-hint-1, eval = FALSE}
ggplot(data = ...)
```

<!-- Maybe mention default arguments here or somewhere else in the tutorial -->

### 

`ggplot()` initializes a ggplot object. Your output should be an empty canvas.

### Exercise 3

<!-- DK: This step goes to fast. Don't forget, this is the first plot that students have ever made. Go slower! -->

Now, map `displ` to the x-axis and `hwy` to the y-axis.

```{r what-you-wont-learn-3, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r what-you-wont-learn-3-hint-1, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(
         x = ...,
         y = ...))
```

### 

Anything included in `aes()` brings some information from the data in our tibble onto the graph. Elsewhere in `ggplot()` and its layers, we change the appearance of the graph without using information from our data.

### Exercise 4

Let's now add the layer `geom_point()`.

```{r what-you-wont-learn-4, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r what-you-wont-learn-4-hint-1, eval = FALSE}
Remember when you add a layer you use +. 
```

```{r what-you-wont-learn-4-hint-2, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(
         x = ...,
         y = ...)) +
  geom_point()
```

### 

`geom_*` functions (such as `geom_point()`) add ggplot objects aadditional layers to the base ggplot. This allows us to create a graphic piece-by-piece.

### Exercise 5

The following code uses the `mpg` tibble to create a scatterplot that displays 126 points, however, it visualizes a data set that contains 234 points. Because many points share similar values, this causes individual data points to be hidden behind other points. This is also known as **overplotting.**

One method to fight overplotting is to make each point **semi-transparent**. The code chunk below provides the code used to create the graph above. Change the transparency of the points by setting `alpha` equal to 0.5 within `geom_point()`.

```{r what-you-wont-learn-5, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r what-you-wont-learn-5-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, y = hwy)) +
  geom_point(alpha = ...)
```

### 

`alpha` only changes the appearance of the graph and does not add new information from the data. Thus, this argument is within the `geom` and is not nested within an `aes`.

### Exercise 6

Now, also within `geom_point()`, set `color` equal to `"steelblue"`.

```{r what-you-wont-learn-6, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r what-you-wont-learn-6-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, y = hwy)) +
  geom_point(alpha = ..., color = "...")
```

### 

R has 657 (built in color names)[https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf?page=3]. Like `alpha`, `color` is not changing the data so the argument is within `geom`.

### Exercise 7

Now, use `labs()` to add labeling to the graph. Set the `title` to `"Measurements for Engine Displacement and Highway Fuel Efficiency of Select Car Models"` and the `subtitle` to `"Cars with greater enginer displacement are less fuel efficient"`. To label the axes, set `x` to `"Engine Displacement (L)"` and `y` to `"Highway Efficiency (mpg)"`. Set the `caption` to `"EPA (2008)"`.

The caption is generally used to credit a project's sources.

```{r what-you-wont-learn-7, exercise = TRUE }

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r what-you-wont-learn-7-hint-1, eval = FALSE}
Remember to add a layer with the function labs()
```

```{r what-you-wont-learn-7-hint-2, eval = FALSE}
... +
  labs(title = "...",
       subtitle = "...",
       x = "...",
       y = "...",
       caption = "...") 
```

Reminder: This is what our graph should look like.

```{r show-scat-p}
scat_p
```

### 

Related geoms to `geom_point()` include `geom_count()` and `geom_bin2d()`.



## Prerequisites
### 

## Running R code
### 

Although the Tidyverse includes hundreds of commands, the most important are `filter()`, `select()`, `arrange()`, `mutate()`, and `summarize()`. Whenever you face a new problem, try to think about which one of these commands might be a good way to start.

### Exercise 1

We will be working more with the `diamonds` tibble. Start with the `diamonds` tibble and then pipe it to `filter(color == "D")`.

```{r running-r-code-1, exercise = TRUE}

```

```{r running-r-code-1-hint-1, eval = FALSE}
diamonds |> 
  filter(color == "D")
```

### 

Most of the questions in this section will follow this example. You will create a "pipeline" --- a sequence of R commands, separated by the pipe symbol: `|>`. Each command takes a tibble as input and, almost always, produces a tibble as output, which is fed to the next command in the pipeline.


### Exercise 2

Start a pipeline with `diamonds`, `filter()` to only keep rows in which `gender` is "Female", `party` is "Republican", and `age` is less than 40.

```{r running-r-code-2, exercise = TRUE}

```

```{r running-r-code-2-hint-1, eval = FALSE}
diamonds |> 
  ...(gender == "Female" & 
      ... == "Republican" &
      age < ...)
```

### 

Instead of creating a single criterion with many parts, like with an `&` as above, you can just separate the parts with a comma. See *The Primer* for details.

### Exercise 3

Start with the pipeline we created above. (Note you can use the "Copy previous code" button to insert the code from the previous exercise.) `select()` two variables: `treatment` and `race`.


```{r running-r-code-3, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-3-hint-1, eval = FALSE}
diamonds |> 
  filter(gender == "Female" & 
         party == "Republican" &
         age < 40) |> 
  select(gender, treatment)
```

### 

The columns are ordered, not by how they appear in the `diamonds` tibble --- where `treatment` comes first --- but as they are ordered in the call to `select()`.


### Exercise 4

Start a new pipeline with the `diamonds` tibble. Select all the columns except for `gender`, `liberal`, `party`, and `age`.


```{r running-r-code-4, exercise = TRUE}

```

```{r running-r-code-4-hint-1, eval = FALSE}
diamonds |> 
  select(-gender, .., ..., ...)
```

### 

Using a minus sign is the easiest way to exclude variables when using `select()`. But you could also have just selected the variables that you wanted to keep.

### Exercise 5

Starting with `diamonds`, `select()` all the variables which appear between `gender` and `age`, inclusive. 

```{r running-r-code-5, exercise = TRUE}

```

```{r running-r-code-5-hint-1, eval = FALSE}
diamonds |> 
  select(...:..)
```

### 

Use a `:` to select a range. Of course, this is only helpful if all the variables you want are grouped together.


### Exercise 6

Pipe `diamonds` to `select()`, keeping the variables, `treatment`, `gender`, and then everything else. Using the `everything()` function to capture the remaining variables.

```{r running-r-code-6, exercise = TRUE}

```

```{r running-r-code-6-hint-1, eval = FALSE}
diamonds |> 
  select(..., ..., everything())
```

### 

Note how we use "pipe" as a verb in the instructions above. You "pipe" a tibble "into" a function. This works as long as the function follows the Tidyverse conventions. Not all functions do.


### Exercise 7

Pipe `diamonds` to `select()` and keep only those variables which start with the letter "a".

```{r running-r-code-7, exercise = TRUE}

```

```{r running-r-code-7-hint-1, eval = FALSE}
diamonds |> 
  select(starts_with("..."))
```

### 

The `select()` function is a core part of the Tidyverse, so there are many "tricks" for keeping just the variables we want, in the order in which we want them.

Note the distinction between **tidyverse**, the actual R package, and "Tidyverse", the conceptual universe of related packages, all of which use a similar approach for data science, centered around the use of the `|>`.



### Exercise 8

Pipe `diamonds` into `select()`, keeping just `treatment`, `gender` and `age`. Continue the pipeline into the `arrange()` function, sorting the tibble so that the youngest participants appear at the top.

```{r running-r-code-8, exercise = TRUE}

```

```{r running-r-code-8-hint-1, eval = FALSE}
diamonds |> 
  ...(treatment, gender, age) |> 
  arrange(...)
```

### 

We could reverse the order by using `arrange(desc(age))`.

### Exercise 9

The `mutate()` function makes it easy to create new variables.

```{r running-r-code-9, exercise = TRUE}

```

```{r running-r-code-9-hint-1, eval = FALSE}
diamonds |> 
  select(gender, ...) |> 
  ...(income_in_thousands = income / 1000)
```

### 

### Exercise 10

The `if_else()` function is often used within a call to `mutate()`. Pipe `diamonds` to `select()`, keeping only one varable: `age`. Then, use mutate to create a new variable, `old`, which is TRUE if `age` > 50 and FALSE otherwise.

```{r running-r-code-10, exercise = TRUE}

```

```{r running-r-code-10-hint-1, eval = FALSE}
diamonds |> 
  ...(age) |> 
  mutate(old = ...(age > ..., TRUE, ...))
```

### 

The `if_else()` function is part of the Tidyverse, coming from the **dplyr** package. The `ifelse()` function is part of "base" R. We recommend always using `if_else()`.

### Exercise 11

Pipe `diamonds` to `summarize()`. Create two new variables --- `mn_age` and `sd_age` --- which are the `mean()` and `sd()` of `age`, respectively.

```{r running-r-code-11, exercise = TRUE}

```

```{r running-r-code-11-hint-1, eval = FALSE}
diamonds |> 
  ...(mn_age = ...(age), 
      ... = sd(age))
```

### 

We also could have calculated these values "directly," e.g., `mean(diamonds$age)`. But doing calculations within a pipe is often more convenient.

### Exercise 12

Use `quantile()` to calculate the the 20% and 80% quantiles of `age` from the `diamonds` tibble.

```{r running-r-code-12, exercise = TRUE}

```

```{r running-r-code-12-hint-1, eval = FALSE}
quantile(diamonds$..., c(..., 0.8))
```

### 

We can also do this calculation within a pipe, but things get trickier because, unlike with `mean()` or `sd()`, quantile returns a vector of length two.


### Exercise 13

Above, we calculated the average `age` for the entire `diamonds` tibble. Now, let's do the same calculation for men and women separately. 

Start the pipe with `diamonds`. Pipe the result to `summarize()` and create a new variable, `avg`, which is the mean age. Set `.by` to `gender`.

```{r running-r-code-13, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-13-hint-1, eval = FALSE}
diamonds |> 
  ...(avg = mean(...),
      .by = ...)
```

### Exercise 14

Pipe `diamonds` to `slice_sample()` and select 4 rows at random.

```{r running-r-code-14, exercise = TRUE}

```

```{r running-r-code-14-hint-1, eval = FALSE}
diamonds |> 
  ...(... = 4)
```

### 

`slice()` filters the row numbers which you specify. `slice_sample()` gets random rows, but you need to provide the `n` argument. When confronting a new tibble, it is always a good idea to look at some rows at random. The top of a tibble often looks very different from the rest of it!



## Summary
### 

This tutorial covered [Chapter 1: Introduction](https://r4ds.hadley.nz/intro.html) from [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. 

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
